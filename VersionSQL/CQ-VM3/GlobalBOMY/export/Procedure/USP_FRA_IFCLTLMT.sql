/****** Object:  Procedure [export].[USP_FRA_IFCLTLMT]    Committed by VersionSQL https://www.versionsql.com ******/

CREATE PROCEDURE [export].[USP_FRA_IFCLTLMT]
(
	@idteProcessDate DATE
)
AS
BEGIN
	SET NOCOUNT ON;

	CREATE TABLE #IFCLTLMT
	(
		COMPANYID CHAR(1),
		BRANCHID CHAR(4),
		EAFID CHAR(3),
		ACCTNO CHAR(10),
		ACCTSBNO CHAR(4),
		MRKTCD CHAR(4),
		BRKGCD CHAR(2),
		BFEFRMLCD CHAR(3),
		SETTMODECD CHAR(2),
		SETTCURR CHAR(3),
		SETTBANK CHAR(50),
		SETTBANKAC CHAR(20),
		SETTACCTNM CHAR(60),
		CDSNUMBER CHAR(20),
		CDSACCTNM CHAR(60),
		CDSACCTNM1 CHAR(60),
		AVGOPT CHAR(1),
		VATIND CHAR(1),
		CALLWARIND CHAR(1),
		TAXIND CHAR(1),
		CLNASSIND CHAR(1),
		CHKLIMIT CHAR(1),
		CHRGAPP CHAR(1),
		SHORTSELL CHAR(1),
		CLRPRVORD CHAR(1),
		ACCESSSR CHAR(1),
		BUYSR CHAR(1),
		SELLSR CHAR(1),
		EXLMPER DECIMAL(5,2),
		TRDLIMIT DECIMAL(15,2),
		BUYOS DECIMAL(15,2),
		SELLOS DECIMAL(15,2),
		NETOS DECIMAL(15,2),
		TOTALOS DECIMAL(15,2),
		DLYBUYLIM DECIMAL(15,2),
		DLYSELLLIM DECIMAL(15,2),
		DLYNETLIM DECIMAL(15,2),
		DLYTOTLIM DECIMAL(15,2),
		DLYBUYAMT DECIMAL(15,2),
		DLYSELLAMT DECIMAL(15,2),
		DLYNETAMT DECIMAL(15,2),
		DLYTOTAMT DECIMAL(15,2),
		MAXBUYLIM DECIMAL(15,2),
		MAXSELLLIM DECIMAL(15,2),
		MAXNETLIM DECIMAL(15,2),
		MINNETLIM DECIMAL(15,2),
		MAXTOTLIM DECIMAL(15,2),
		MINTOTLIM DECIMAL(15,2),
		TPURCOS DECIMAL(15,2),
		TSALESOS DECIMAL(15,2),
		CONTRAGOS DECIMAL(15,2),
		CONTRALOS DECIMAL(15,2),
		SETOFFGOS DECIMAL(15,2),
		SETOFFLOS DECIMAL(15,2),
		NETGOS DECIMAL(15,2),
		NETLOS DECIMAL(15,2),
		CRNOTEOS DECIMAL(15,2),
		DBNOTEOS DECIMAL(15,2),
		TBONUSOS DECIMAL(15,2),
		TRIGHTOS DECIMAL(15,2),
		CASHACCTBL DECIMAL(15,2),
		BFEDLRID DECIMAL(5,0),
		BFERDLRID DECIMAL(5,0),
		BFERSGNST CHAR(1),
		SRVRTCDDS CHAR(3),
		SRVRTCDCF CHAR(3),
		SRVRTCDST CHAR(3),
		SRVRTCDVT CHAR(3),
		USRCREATED CHAR(10),
		DTCREATED DATE,
		TMCREATED CHAR(8),
		USRUPDATED CHAR(10),
		DTUPDATED DATE,
		TMUPDATED CHAR(8),
		RCDSTAT CHAR(1),
		RCDVERSION DECIMAL(5,0),
		PGMLSTUPD CHAR(10),
		TRIGGERACT CHAR(1),
		ISLSECIND CHAR(1),
		PRTCONT CHAR(1),
		PRTCONTOPT CHAR(1),
		BANKCD CHAR(4),
		BANKBRANCH CHAR(10),
		DUPCONBKG CHAR(2),
		DIRECTCRDT DATE,
		CASHBKID CHAR(3),
		SETOFFIND CHAR(1),
		CONTRAIND CHAR(1),
		CONFTRDIND CHAR(1),
		ADVDLVDAY DECIMAL(3,0),
		ADVPAYDAY DECIMAL(3,0),
		NOMININD CHAR(1),
		RASIND CHAR(1),
		SUSPDREASN CHAR(4),
		DTSUSPND DATE,
		USRSUSPND CHAR(10),
		ARBITRTIND CHAR(1),
		DTCDSACOPN DATE,
		BFEACTYPE CHAR(3),
		IDXBUYLIM DECIMAL(5,2),
		IDXSELLIM DECIMAL(5,2),
		IDXNETLIM DECIMAL(5,2),
		IDXTOTLIM DECIMAL(5,2),
		IDDBUYLIM DECIMAL(5,2),
		IDDSELLIM DECIMAL(5,2),
		IDDNETLIM DECIMAL(5,2),
		IDDTOTLIM DECIMAL(5,2),
		IDNNETLIM DECIMAL(5,2),
		IDNTOTLIM DECIMAL(5,2),
		MAXAMTTRX DECIMAL(15,2),
		PRCDSPMODE CHAR(10)
	)

	INSERT INTO #IFCLTLMT
	(
		COMPANYID,
		BRANCHID,
		EAFID,
		ACCTNO,
		ACCTSBNO,
		MRKTCD,
		BRKGCD,
		BFEFRMLCD,
		SETTMODECD,
		SETTCURR,
		SETTBANK,
		SETTBANKAC,
		SETTACCTNM,
		CDSNUMBER,
		CDSACCTNM,
		CDSACCTNM1,
		AVGOPT,
		VATIND,
		CALLWARIND,
		TAXIND,
		CLNASSIND,
		CHKLIMIT,
		CHRGAPP,
		SHORTSELL,
		CLRPRVORD,
		ACCESSSR,
		BUYSR,
		SELLSR,
		EXLMPER,
		TRDLIMIT,
		BUYOS,
		SELLOS,
		NETOS,
		TOTALOS,
		DLYBUYLIM,
		DLYSELLLIM,
		DLYNETLIM,
		DLYTOTLIM,
		DLYBUYAMT,
		DLYSELLAMT,
		DLYNETAMT,
		DLYTOTAMT,
		MAXBUYLIM,
		MAXSELLLIM,
		MAXNETLIM,
		MINNETLIM,
		MAXTOTLIM,
		MINTOTLIM,
		TPURCOS,
		TSALESOS,
		CONTRAGOS,
		CONTRALOS,
		SETOFFGOS,
		SETOFFLOS,
		NETGOS,
		NETLOS,
		CRNOTEOS,
		DBNOTEOS,
		TBONUSOS,
		TRIGHTOS,
		CASHACCTBL,
		BFEDLRID,
		BFERDLRID,
		BFERSGNST,
		SRVRTCDDS,
		SRVRTCDCF,
		SRVRTCDST,
		SRVRTCDVT,
		USRCREATED,
		DTCREATED,
		TMCREATED,
		USRUPDATED,
		DTUPDATED,
		TMUPDATED,
		RCDSTAT,
		RCDVERSION,
		PGMLSTUPD,
		TRIGGERACT,
		ISLSECIND,
		PRTCONT,
		PRTCONTOPT,
		BANKCD,
		BANKBRANCH,
		DUPCONBKG,
		DIRECTCRDT,
		CASHBKID,
		SETOFFIND,
		CONTRAIND,
		CONFTRDIND,
		ADVDLVDAY,
		ADVPAYDAY,
		NOMININD,
		RASIND,
		SUSPDREASN,
		DTSUSPND,
		USRSUSPND,
		ARBITRTIND,
		DTCDSACOPN,
		BFEACTYPE,
		IDXBUYLIM,
		IDXSELLIM,
		IDXNETLIM,
		IDXTOTLIM,
		IDDBUYLIM,
		IDDSELLIM,
		IDDNETLIM,
		IDDTOTLIM,
		IDNNETLIM,
		IDNTOTLIM,
		MAXAMTTRX,
		PRCDSPMODE
	)
	SELECT 
			'',
			ACCOUNT.[CDSACOpenBranch (selectsource-4)],
			'',
			ACCOUNT.[AccountNumber (textinput-5)],
			'',
			'',
			'',
			'',
			'',
			'',--10

			'',
			'',
			'',
			'',
			ACCOUNT.[CDSNo (textinput-19)],
			'',
			'',
			'',
			'',
			'',--20

			'',
			'',
			'',
			'',
			'',
			'',
			'',
			'',
			'',
			'', --30

			ACCOUNT.[AvailableTradingLimit (textinput-55)],
			'',
			'',
			'',
			'',
			'',
			'',
			ACCOUNT.[MaxNetLimit (textinput-70)],
			'',
			'',
			'',
			'',
			'',
			'',
			'',
			'',
			'',
			'',
			'',
			'',
			'',
			'',
			'',
			'',
			'',
			'',
			'',
			'',
			'',
			'',
			'',
			'',
			'',
			'',
			'',
			'',
			'',
			'',
			'',
			'',
			'',
			'',
			'',
			'',
			'',
			'',
			'',
			'',
			'',
			'',
			'',
			'',
			'',
			'',
			'',
			'',
			'',
			'',
			'',
			'',
			'',
			'',
			'',
			'',
			'',
			'',
			'',
			'',
			'',
			ACCOUNT.[BFEACType (selectsource-29)],
			'',
			'',
			'',
			'',
			'',
			'',
			'',
			'',
			'',
			'',
			''
	FROM CQBTempDB.export.Tb_FormData_1409 ACCOUNT
		INNER JOIN 
		CQbTempDB.export.Tb_FormData_1410 CUSTOMER 
		ON CUSTOMER.[CustomerID (textinput-1)] = ACCOUNT.[CustomerID (selectsource-1)]


	-- RESULT SET

	SELECT 
	 COMPANYID + BRANCHID + EAFID + ACCTNO + ACCTSBNO + MRKTCD + BRKGCD + BFEFRMLCD + SETTMODECD + SETTCURR + SETTBANK +
		SETTBANKAC + SETTACCTNM + CDSNUMBER + CDSACCTNM + CDSACCTNM1 + AVGOPT + VATIND + CALLWARIND + TAXIND + CLNASSIND +
		CHKLIMIT + CHRGAPP + SHORTSELL + CLRPRVORD + ACCESSSR + BUYSR + SELLSR + CAST(EXLMPER AS CHAR(8)) + CAST(TRDLIMIT AS CHAR(8)) + CAST(BUYOS AS CHAR(8)) + CAST(SELLOS AS CHAR(8)) +
		CAST(NETOS AS CHAR(8)) + CAST(TOTALOS AS CHAR(8)) + CAST(DLYBUYLIM AS CHAR(8)) + CAST(DLYSELLLIM AS CHAR(8)) + CAST(DLYNETLIM AS CHAR(8)) + CAST(DLYTOTLIM AS CHAR(8)) + CAST(DLYBUYAMT AS CHAR(8)) + CAST(DLYSELLAMT AS CHAR(8)) + CAST(DLYNETAMT AS CHAR(8)) + CAST(DLYTOTAMT AS CHAR(8)) +
		CAST(MAXBUYLIM AS CHAR(8)) + CAST(MAXSELLLIM AS CHAR(8)) + CAST(MAXNETLIM AS CHAR(8)) + CAST(MINNETLIM AS CHAR(8)) + CAST(MAXTOTLIM AS CHAR(8)) + CAST(MINTOTLIM AS CHAR(8)) + CAST(TPURCOS AS CHAR(8)) + CAST(TSALESOS AS CHAR(8)) + CAST(CONTRAGOS AS CHAR(8)) + CAST(CONTRALOS AS CHAR(8)) +
		CAST(SETOFFGOS AS CHAR(8)) + CAST(SETOFFLOS AS CHAR(8)) + CAST(NETGOS AS CHAR(8)) + CAST(NETLOS AS CHAR(8)) + CAST(CRNOTEOS AS CHAR(8)) + CAST(DBNOTEOS AS CHAR(8)) + CAST(TBONUSOS AS CHAR(8)) + CAST(TRIGHTOS AS CHAR(8)) + CAST(CASHACCTBL AS CHAR(8)) + CAST(BFEDLRID AS CHAR(8)) + CAST(BFERDLRID AS CHAR(8)) +
		BFERSGNST + SRVRTCDDS + SRVRTCDCF + SRVRTCDST + SRVRTCDVT + USRCREATED + DTCREATED + TMCREATED + USRUPDATED +
		DTUPDATED + TMUPDATED + RCDSTAT + CAST(RCDVERSION AS CHAR(8)) + PGMLSTUPD + TRIGGERACT + ISLSECIND + PRTCONT + PRTCONTOPT +
		BANKCD + BANKBRANCH + DUPCONBKG + DIRECTCRDT + CASHBKID + SETOFFIND + CONTRAIND + CONFTRDIND + CAST(ADVDLVDAY AS CHAR(8)) + CAST(ADVPAYDAY AS CHAR(8)) +
		NOMININD + RASIND + SUSPDREASN + DTSUSPND + USRSUSPND + ARBITRTIND + DTCDSACOPN + BFEACTYPE + CAST(IDXBUYLIM AS CHAR(8)) + CAST(IDXSELLIM AS CHAR(8)) +
		CAST(IDXNETLIM AS CHAR(8)) + CAST(IDXTOTLIM AS CHAR(8)) + CAST(IDDBUYLIM AS CHAR(8)) + CAST(IDDSELLIM AS CHAR(8)) + CAST(IDDNETLIM AS CHAR(8)) + CAST(IDDTOTLIM AS CHAR(8)) + CAST(IDNNETLIM AS CHAR(8)) + CAST(IDNTOTLIM AS CHAR(8)) + CAST(MAXAMTTRX AS CHAR(8)) + PRCDSPMODE
	 FROM #IFCLTLMT

END