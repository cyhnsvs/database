/****** Object:  Procedure [export].[USP_FRA_IFDEALER]    Committed by VersionSQL https://www.versionsql.com ******/

CREATE PROCEDURE [export].[USP_FRA_IFDEALER] 
(
	@idteProcessDate DATE
)
AS
BEGIN

	SET NOCOUNT ON;

	CREATE TABLE #IFDEALER
	(
		BROKERCD CHAR(5),
		DLREAFID CHAR(3),
		DEALERCD CHAR(4),
		COMPANYID CHAR(1),
		BRANCHID CHAR(4),
		EAFID CHAR(3),
		ACCTNO CHAR(10),
		ACCTSBNO CHAR(4),
		DEALERNM CHAR(60),
		CORRADDR1 CHAR(40),
		CORRADDR2 CHAR(40),
		CORRADDR3 CHAR(40),
		CORRADDR4 CHAR(40),
		CORRPOSTCD CHAR(10),
		PHONE CHAR(15),
		PHONE1 CHAR(15),
		FAX CHAR(15),
		DLRREGNO CHAR(15),
		DLRREGEXDT CHAR(10),
		IDTYPECD CHAR(2),
		IDNUMBER CHAR(15),
		IDTYPECD1 CHAR(2),
		IDNUMBER1 CHAR(15),
		SEX CHAR(1),
		DLRINTDEP DECIMAL(15,2),
		DLTCURDEP DECIMAL(15,2),
		DLYBUYAMT DECIMAL(15,2),
		DLYBUYLIM DECIMAL(15,2),
		DLYSELLAMT DECIMAL(15,2),
		DLYSELLLIM DECIMAL(15,2),
		TRDLIMIT DECIMAL(15,2),
		DLRCOMMR DECIMAL(15,2),
		DEALERCD1 CHAR(4),
		DTEXPREASN DATE,
		USRCREATED CHAR(8),
		DTCREATED CHAR(10),
		TMCREATED DATE,
		USRUPDATED CHAR(8),
		DTUPDATED CHAR(1),
		TMUPDATED DECIMAL(5,0),
		RCDSTAT CHAR(10),
		RCDVERSION CHAR(1),
		PGMLSTUPD CHAR(3),
		TRIGGERACT CHAR(3),
		BFEDLRID DECIMAL(5,0),
		BFERDLRID DECIMAL(5,0),
		BFERSGNST CHAR(1),
		BFESRVID CHAR(1),
		RACECD CHAR(2),
		DEALERTP CHAR(2),
		DEALERPOS CHAR(4),
		RASIND CHAR(1),
		COMMPAYRT DECIMAL(9,6),
		MAXCOMMPAY DECIMAL(15,2),
		MINCOMMPAY DECIMAL(15,2),
		TEXT1 CHAR(10),

		MAXBUYLIM DECIMAL(15,2),
		MAXSELLLIM DECIMAL(15,2),
		MAXNETLIM DECIMAL(15,2),
		MAXTOTLIM DECIMAL(15,2),
		MINNETLIM DECIMAL(15,2),
		MINTOTLIM DECIMAL(15,2),
		DLYNETLIM DECIMAL(15,2),
		DLYTOTLIM DECIMAL(15,2),
		DLYNETAMT DECIMAL(15,2),
		DLYTOTAMT DECIMAL(15,2),
		IDXBUYLIM DECIMAL(5,2),
		IDXSELLIM DECIMAL(5,2),
		IDXNETLIM DECIMAL(5,2),
		IDXTOTLIM DECIMAL(5,2),
		IDDBUYLIM DECIMAL(5,2),
		IDDSELLIM DECIMAL(5,2),
		IDDNETLIM DECIMAL(5,2),
		IDDTOTLIM DECIMAL(5,2),
		IDNNETLIM DECIMAL(5,2),
		IDNTOTLIM DECIMAL(5,2),
		CRDRANKCD CHAR(2),
		ACCESSLVL CHAR(2),
		GRPPRFID CHAR(10),
		CUSTKEY CHAR(10),
		ACCTNO1 CHAR(10),
		ACCTSBNO1 CHAR(4),
		ADJUSTLIM DECIMAL(15,2)
	)

	INSERT INTO #IFDEALER
	(
		BROKERCD,
		DLREAFID,
		DEALERCD,
		COMPANYID,
		BRANCHID,
		EAFID,
		ACCTNO,
		ACCTSBNO,
		DEALERNM,
		CORRADDR1,
		CORRADDR2,
		CORRADDR3,
		CORRADDR4,
		CORRPOSTCD,
		PHONE,
		PHONE1,
		FAX,
		DLRREGNO,
		DLRREGEXDT,
		IDTYPECD,
		IDNUMBER,
		IDTYPECD1,
		IDNUMBER1,
		SEX,
		DLRINTDEP,
		DLTCURDEP,
		DLYBUYAMT,
		DLYBUYLIM,
		DLYSELLAMT,
		DLYSELLLIM,
		TRDLIMIT,
		DLRCOMMR,
		DEALERCD1,
		DTEXPREASN,
		USRCREATED,
		DTCREATED,
		TMCREATED,
		USRUPDATED,
		DTUPDATED,
		TMUPDATED,
		RCDSTAT,
		RCDVERSION,
		PGMLSTUPD,
		TRIGGERACT,
		BFEDLRID,
		BFERDLRID,
		BFERSGNST,
		BFESRVID,
		RACECD,
		DEALERTP,
		DEALERPOS,
		RASIND,
		COMMPAYRT,
		MAXCOMMPAY,
		MINCOMMPAY,
		TEXT1,
		MAXBUYLIM,
		MAXSELLLIM,
		MAXNETLIM,
		MAXTOTLIM,
		MINNETLIM,
		MINTOTLIM,
		DLYNETLIM,
		DLYTOTLIM,
		DLYNETAMT,
		DLYTOTAMT,
		IDXBUYLIM,
		IDXSELLIM,
		IDXNETLIM,
		IDXTOTLIM,
		IDDBUYLIM,
		IDDSELLIM,
		IDDNETLIM,
		IDDTOTLIM,
		IDNNETLIM,
		IDNTOTLIM,
		CRDRANKCD,
		ACCESSLVL,
		GRPPRFID,
		CUSTKEY,
		ACCTNO1,
		ACCTSBNO1,
		ADJUSTLIM
	)
	SELECT 
		'',
		'',
		DELAR.[DealerCode (textinput-35)],
		'',
		DELAR.[BranchID (selectsource-1)],
		'',
		'',
		'',
		DELAR.[Name (textinput-3)],
		DELAR.[Address1 (textinput-11)],

		DELAR.[Address2 (textinput-14)],
		DELAR.[Address3 (textinput-13)],
		DELAR.[State (selectsource-14)],
		'',
		DELAR.[Phone (textinput-16)],
		DELAR.[MobilePhone (textinput-17)],
		'',
		'',
		DELAR.[LicenseSince (dateinput-1)],--DLRREGEXDT
		'',

		DELAR.[IDNumber (textinput-9)],
		'',
		DELAR.[AlternateIDno (textinput-10)],--IDNUMBER1
		'',
		'',
		'',
		'',
		'',
		'',
		'',

		'',
		'',
		'',
		'',
		'',
		'',
		'',
		'',
		'',
		'',

		DELAR.[State (textinput-36)],
		'',--RCDVERSION
		'',
		'',
		'',
		'',
		'',
		'',
		'',
		DELAR.[Race (selectsource-5)],--RACECD

		DELAR.[DealerType (selectsource-3)],--DEALERTP
		'',
		'',
		'',
		'',
		'',
		'',
		'',
		'',
		'',

		'',
		'',
		'',
		'',
		'',
		'',
		'',
		'',
		'',
		'',

		'',
		'',
		'',
		'',
		'',
		'',
		'',
		'',
		'',
		'',

		'',
		'',
		''
	FROM CQBTempDB.export.Tb_FormData_1377 DELAR

	-- RESULT SET

	SELECT 
		BROKERCD + DLREAFID + DEALERCD + COMPANYID + BRANCHID + EAFID + ACCTNO + ACCTSBNO + DEALERNM + CORRADDR1 +
		CORRADDR2 + CORRADDR3 + CORRADDR4 + CORRPOSTCD + PHONE + PHONE1 + FAX + DLRREGNO + DLRREGEXDT + IDTYPECD + IDNUMBER +
		IDTYPECD1 + IDNUMBER1 + SEX + CAST(DLRINTDEP AS CHAR(8)) + CAST(DLTCURDEP AS CHAR(8)) + CAST(DLYBUYAMT AS CHAR(8)) + CAST(DLYBUYLIM AS CHAR(8)) + CAST(DLYSELLAMT AS CHAR(8)) + CAST(DLYSELLLIM AS CHAR(8)) + CAST(TRDLIMIT AS CHAR(8)) +
		CAST(DLRCOMMR AS CHAR(8)) + DEALERCD1 + DTEXPREASN + USRCREATED + DTCREATED + TMCREATED + USRUPDATED + DTUPDATED + CAST(TMUPDATED AS CHAR(8)) +
		RCDSTAT + RCDVERSION + PGMLSTUPD + TRIGGERACT + CAST(BFEDLRID AS CHAR(8)) + CAST(BFERDLRID AS CHAR(8)) + BFERSGNST + BFESRVID + RACECD + DEALERTP +
		DEALERPOS + RASIND +  CAST(COMMPAYRT AS CHAR(8)) +  CAST(MAXCOMMPAY AS CHAR(8)) +  CAST(MINCOMMPAY AS CHAR(8)) + TEXT1 +  CAST(MAXBUYLIM AS CHAR(8)) +  CAST(MAXSELLLIM AS CHAR(8)) +  CAST(MAXNETLIM AS CHAR(8)) +  CAST(MAXTOTLIM AS CHAR(8)) +
		 CAST(MINNETLIM AS CHAR(8)) +  CAST(MINTOTLIM AS CHAR(8)) +  CAST(DLYNETLIM AS CHAR(8)) +  CAST(DLYTOTLIM AS CHAR(8)) +  CAST(DLYNETAMT AS CHAR(8)) +  CAST(DLYTOTAMT AS CHAR(8)) +  CAST(IDXBUYLIM AS CHAR(8)) +  CAST(IDXSELLIM AS CHAR(8)) +  CAST(IDXNETLIM AS CHAR(8)) +  CAST(IDXTOTLIM AS CHAR(8)) +
		 CAST(IDDBUYLIM AS CHAR(8)) +  CAST(IDDSELLIM AS CHAR(8)) +  CAST(IDDNETLIM AS CHAR(8)) +  CAST(IDDTOTLIM AS CHAR(8)) +  CAST(IDNNETLIM AS CHAR(8)) +  CAST(IDNTOTLIM AS CHAR(8)) + CRDRANKCD + ACCESSLVL + GRPPRFID + CUSTKEY +
		ACCTNO1 + ACCTSBNO1 + CAST(ADJUSTLIM AS CHAR(8))
	FROM #IFDEALER

	DROP TABLE #IFDEALER
END